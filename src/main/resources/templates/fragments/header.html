<div th:fragment="header" id="header">
  <meta
    name="user-id"
    th:content="${session.currentStaff != null ? session.currentStaff.id : ''}"
  />
  <a th:href="@{/}" class="logo">
    <img th:src="@{/assets/pic/logo.jpg}" alt="Dinio Logo" />
  </a>

  <button
    class="hamburger"
    id="hamburger"
    type="button"
    aria-label="Mở menu"
    aria-expanded="false"
  >
    <i class="fa-solid fa-bars"></i>
  </button>

  <nav id="menu">
    <a class="item" th:href="@{/}">Trang chủ</a>
    <a class="item" th:href="@{/menu}">Thực đơn</a>
    <a class="item" th:href="@{/story}">Câu chuyện</a>
    <a class="item" th:href="@{/contact}">Liên hệ</a>
  </nav>

  <div class="mobile-menu" id="mobileMenu" role="dialog" aria-label="Menu">
    <a class="m-item" th:href="@{/}">Trang chủ</a>
    <a class="m-item" th:href="@{/menu}">Thực đơn</a>
    <a class="m-item" th:href="@{/story}">Câu chuyện</a>
    <a class="m-item" th:href="@{/contact}">Liên hệ</a>
  </div>

  <nav id="action">
    <button
      class="item notify"
      id="notifyBtn"
      type="button"
      title="Thông báo"
      aria-haspopup="dialog"
      aria-expanded="false"
      onclick="window.location.href = '/dinio/customer/notifications'"
    >
      <i class="fa-regular fa-bell"></i>
      <span class="notify-badge" id="notifyBadge"></span>
    </button>

    <div class="notify-pop" id="notifyPop" role="dialog" aria-label="Thông báo">
      <div class="notify-head">
        <div class="notify-title">Thông báo</div>
        <button
          class="notify-close"
          id="notifyClose"
          type="button"
          aria-label="Đóng"
        >
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <div class="notify-tabs" role="tablist" aria-label="Bộ lọc">
        <button
          class="notify-tab is-active"
          type="button"
          data-filter="all"
          role="tab"
          aria-selected="true"
        >
          Tất cả
        </button>
        <button
          class="notify-tab"
          type="button"
          data-filter="unread"
          role="tab"
          aria-selected="false"
        >
          Chưa đọc
        </button>
      </div>

      <div class="notify-list" id="notifyList"></div>

      <a class="notify-footer" th:href="@{/customer/notifications}"
        >Xem tất cả</a
      >
    </div>

    <a class="item cart" th:href="@{/cart}" title="Giỏ hàng">
      <i class="fa-solid fa-cart-shopping"></i>
    </a>

    <div class="item user-menu" id="userMenu">
      <button
        class="user-btn"
        id="userBtn"
        type="button"
        aria-haspopup="menu"
        aria-expanded="false"
      >
        <i class="fa-regular fa-user"></i>
      </button>

      <div class="user-dropdown" id="userDropdown" role="menu">
        <a th:href="@{/profile}" role="menuitem">Hồ sơ</a>
        <a th:href="@{/reservation/tables}" role="menuitem">Đặt bàn</a>
        <a th:href="@{/reservations/my}" role="menuitem">Lịch đặt bàn</a>

        <div class="divider"></div>

        <a
          th:if="${session.currentUser == null and session.currentStaff == null}"
          th:href="@{/login}"
          role="menuitem"
        >
          Đăng nhập
        </a>

        <form
          th:if="${session.currentStaff != null}"
          th:action="@{/staff/logout}"
          method="post"
          style="margin: 0"
        >
          <button
            type="submit"
            class="dropdown-logout"
            role="menuitem"
            style="
              all: unset;
              cursor: pointer;
              display: block;
              width: 100%;
              padding: 10px 12px;
            "
          >
            Đăng xuất
          </button>
        </form>

        <form
          th:if="${session.currentUser != null}"
          th:action="@{/logout}"
          method="post"
          style="margin: 0"
        >
          <button
            type="submit"
            class="dropdown-logout"
            role="menuitem"
            style="
              all: unset;
              cursor: pointer;
              display: block;
              width: 100%;
              padding: 10px 12px;
            "
          >
            Đăng xuất
          </button>
        </form>
      </div>
    </div>
  </nav>
</div>
